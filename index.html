<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Color‑Block Timer</title>
  <style>
    :root{
      --bg: #0b0b0f; --fg: #f6f7fb; --muted:#9aa3b2; --card:#13141a; --accent:#5b8cff; --danger:#ff5470; --ok:#2ecc71;
      --focus: #ffd400; --border:#232634;
    }
    [data-theme="light"]{ --bg:#f7f8fb; --fg:#0c0d11; --muted:#54607a; --card:#ffffff; --accent:#2a63ff; --danger:#c71f3a; --ok:#148f49; --border:#e5e7ef; --focus:#a66b00; }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji"}
    .app{max-width:960px;margin:0 auto;padding:16px}
    header{display:flex;align-items:center;gap:12px;justify-content:space-between}
    h1{font-size:1.25rem;margin:0}
    .muted{color:var(--muted)}
    .btn{appearance:none;border:1px solid var(--border);background:var(--card);color:var(--fg);padding:10px 14px;border-radius:12px;cursor:pointer}
    .btn.primary{background:var(--accent);border-color:transparent;color:white}
    .btn.ghost{background:transparent}
    .btn.danger{background:var(--danger);border-color:transparent;color:white}
    .btn:focus{outline:3px solid var(--focus);outline-offset:2px}
    .row{display:flex;gap:12px;align-items:center}
    .stack{display:flex;flex-direction:column;gap:12px}
    .grid{display:grid;gap:12px}
    .list{display:grid;gap:12px;margin-block:16px}
    .card{background:var(--card);border:1px solid var(--border);padding:14px;border-radius:16px}
    .card:hover{border-color:var(--accent)}
    label{font-weight:600}
    input[type="text"], input[type="number"], select{width:100%;box-sizing:border-box;padding:10px;border-radius:12px;border:1px solid var(--border);background:var(--bg);color:var(--fg)}
    input[type="color"]{width:44px;height:36px;border-radius:8px;border:1px solid var(--border);background:transparent;padding:0}
    .small{font-size:.9rem}
    .right{margin-left:auto}
    .section-title{font-weight:700;font-size:1rem;margin:8px 0}
    .error{color:var(--danger)}
    .ok{color:var(--ok)}
    .pill{font-size:.8rem;background:var(--bg);border:1px solid var(--border);padding:4px 8px;border-radius:999px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap}
    .sr-only{position:absolute!important;left:-10000px!important;top:auto!important;width:1px!important;height:1px!important;overflow:hidden!important}

    /* Run view */
    .run-root{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;cursor:pointer}
    .run-overlay{position:fixed;left:0;right:0;top:0;display:flex;gap:8px;align-items:center;justify-content:space-between;padding:10px}
    .run-panel{background:rgba(0,0,0,.35);backdrop-filter:blur(8px);border-radius:16px;padding:10px;display:flex;gap:8px;align-items:center}
    .run-info{position:fixed;left:10px;bottom:10px;background:rgba(0,0,0,.35);backdrop-filter:blur(8px);padding:10px 14px;border-radius:12px;font-weight:600}

    /* Simple tabs/pages */
    .page{display:none}
    .page.active{display:block}

    /* Table-like rows for blocks */
    .blocks{display:grid;gap:8px}
    .block-row{display:grid;grid-template-columns:120px 110px 1fr 40px;gap:8px;align-items:center}
    @media (max-width:640px){
      .block-row{grid-template-columns:1fr 1fr 1fr 40px}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Color‑Block Timer <span class="muted small">MVP</span></h1>
      <nav class="toolbar" aria-label="Top toolbar">
        <button class="btn" id="installBtn" title="Install app (PWA)" hidden>Install</button>
        <button class="btn" id="settingsBtn" title="Settings">Settings</button>
        <button class="btn" id="themeBtn" title="Toggle theme">Theme</button>
      </nav>
    </header>

    <!-- Page: List -->
    <section id="page-list" class="page active">
      <div class="row" style="margin-top:16px">
        <div class="stack" style="flex:1">
          <div class="muted">Your timers</div>
          <div class="small muted">Click a timer to run it full‑screen. Create as many as you like.</div>
        </div>
        <button class="btn primary" id="addTimerBtn">Add Timer</button>
      </div>
      <div id="timerList" class="list" role="list" aria-label="Timers"></div>
      <div id="emptyState" class="card" style="display:none">
        <div class="stack">
          <div><strong>No timers yet.</strong></div>
          <div class="muted small">Create your first timer with color blocks that change at specific times (e.g. 0s yellow, 300s green, 560s blue, 600s red).</div>
          <div><button class="btn primary" id="createSampleBtn">Create sample Pomodoro</button></div>
        </div>
      </div>
    </section>

    <!-- Page: Edit -->
    <section id="page-edit" class="page">
      <div class="stack" style="margin-top:16px">
        <div class="row">
          <button class="btn" id="backFromEdit">← Back</button>
          <div class="right"></div>
          <button class="btn danger" id="deleteTimerBtn" title="Delete timer">Delete</button>
          <button class="btn primary" id="saveTimerBtn" title="Save timer">Save</button>
        </div>
        <div class="card stack">
          <div class="grid" style="grid-template-columns:1fr 1fr;gap:12px">
            <div class="stack">
              <label for="timerName">Timer name</label>
              <input id="timerName" type="text" placeholder="e.g., Writing Sprint"/>
            </div>
            <div class="stack">
              <label for="defaultLabel">Default block label <span class="muted small">(optional)</span></label>
              <input id="defaultLabel" type="text" placeholder="e.g., Focus"/>
            </div>
          </div>
          <div class="section-title">Blocks <span class="muted small">(first block must start at 0 seconds)</span></div>
          <div id="blocks" class="blocks"></div>
          <div class="toolbar">
            <button class="btn" id="addBlockBtn">Add Block</button>
            <button class="btn" id="sortBlocksBtn">Sort by time</button>
            <button class="btn" id="validateBtn">Validate</button>
            <span id="validateMsg" class="small"></span>
          </div>
        </div>
      </div>
    </section>

    <!-- Page: Run -->
    <section id="page-run" class="page">
      <div id="runRoot" class="run-root" aria-live="polite" aria-atomic="true">
        <div class="run-overlay">
          <div class="run-panel">
            <button class="btn" id="backFromRun">← Back</button>
            <div id="runTitle" class="pill"></div>
          </div>
          <div class="run-panel">
            <button class="btn" id="startBtn">Start</button>
            <button class="btn" id="pauseBtn">Pause</button>
            <button class="btn" id="resetBtn">Reset</button>
            <button class="btn" id="fullscreenBtn" title="Fullscreen">⛶</button>
          </div>
        </div>
        <div id="runInfo" class="run-info">—</div>
      </div>
    </section>

    <!-- Page: Settings -->
    <section id="page-settings" class="page">
      <div class="stack" style="margin-top:16px">
        <button class="btn" id="backFromSettings">← Back</button>
        <div class="card stack">
          <div class="section-title">Preferences</div>
          <div class="grid" style="grid-template-columns:1fr 1fr;gap:12px">
            <label class="row"><input type="checkbox" id="prefSpeak"/> <span>Speak block changes</span></label>
            <label class="row"><input type="checkbox" id="prefVibrate"/> <span>Vibrate on change</span></label>
            <label class="row"><input type="checkbox" id="prefWake"/> <span>Prevent screen sleep while running</span></label>
            <div class="row"><label for="prefTheme" class="sr-only">Theme</label>
              <select id="prefTheme">
                <option value="system">Theme: System</option>
                <option value="light">Theme: Light</option>
                <option value="dark">Theme: Dark</option>
              </select>
            </div>
          </div>
        </div>
        <div class="card stack">
          <div class="section-title">Import / Export</div>
          <div class="toolbar">
            <button class="btn" id="exportBtn">Export Timers (JSON)</button>
            <input class="btn" type="file" id="importFile" accept="application/json" />
          </div>
          <div class="muted small">Back up or share your timers. Import validates and merges by ID.</div>
        </div>
        <div class="card stack">
          <div class="section-title">Firebase (optional)</div>
          <div class="muted small">This MVP uses localStorage. We can wire Firebase Auth/Firestore next once you paste config. See JS: <code>initFirebase()</code> stub.</div>
        </div>
      </div>
    </section>

    <div id="liveRegion" class="sr-only" aria-live="polite" aria-atomic="true"></div>
  </div>

  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyDLqaK8HtwUWCVMvtg7GgwgGXyv4i0_zP0",
      authDomain: "color-block-timer.firebaseapp.com",
      projectId: "color-block-timer",
      storageBucket: "color-block-timer.firebasestorage.app",
      messagingSenderId: "930168399039",
      appId: "1:930168399039:web:18d886fcd7f7912fa3920a",
      measurementId: "G-9YZ0C829CY"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
<script src="app.js"></script>
</body>
</html>

